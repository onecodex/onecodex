{"$schema": "http://json-schema.org/draft-04/hyper-schema#", "links": [{"href": "/api/v1/controls/schema", "method": "GET", "rel": "describedBy"}, {"href": "/api/v1/controls/{id}/files", "method": "GET", "rel": "files", "targetSchema": {"type": "string"}}, {"href": "/api/v1/controls", "method": "GET", "rel": "instances", "schema": {"additionalProperties": true, "properties": {"page": {"default": 1, "minimum": 1, "type": "integer"}, "per_page": {"default": 20, "maximum": 1000, "minimum": 1, "type": "integer"}, "sort": {"additionalProperties": false, "properties": {"$uri": {"description": "Sort by $uri in descending order if 'true', ascending order if 'false'.", "type": "boolean"}, "complete": {"description": "Sort by complete in descending order if 'true', ascending order if 'false'.", "type": "boolean"}, "created_at": {"description": "Sort by created_at in descending order if 'true', ascending order if 'false'.", "type": "boolean"}, "error_msg": {"description": "Sort by error_msg in descending order if 'true', ascending order if 'false'.", "type": "boolean"}, "job": {"description": "Sort by job in descending order if 'true', ascending order if 'false'.", "type": "boolean"}, "sample": {"description": "Sort by sample in descending order if 'true', ascending order if 'false'.", "type": "boolean"}, "success": {"description": "Sort by success in descending order if 'true', ascending order if 'false'.", "type": "boolean"}}, "type": "object"}, "where": {"additionalProperties": false, "properties": {"$uri": {"anyOf": [{"pattern": "^\\/api\\/v1\\/controls\\/[^/]+$", "type": "string"}, {"additionalProperties": false, "properties": {"$eq": {"pattern": "^\\/api\\/v1\\/controls\\/[^/]+$", "type": "string"}}, "required": ["$eq"], "type": "object"}, {"additionalProperties": false, "properties": {"$ne": {"pattern": "^\\/api\\/v1\\/controls\\/[^/]+$", "type": "string"}}, "required": ["$ne"], "type": "object"}, {"additionalProperties": false, "properties": {"$in": {"default": [], "items": {"pattern": "^\\/api\\/v1\\/controls\\/[^/]+$", "type": "string"}, "minItems": 0, "type": "array", "uniqueItems": true}}, "required": ["$in"], "type": "object"}]}, "complete": {"anyOf": [{"type": ["boolean", "null"]}, {"additionalProperties": false, "properties": {"$eq": {"type": ["boolean", "null"]}}, "required": ["$eq"], "type": "object"}, {"additionalProperties": false, "properties": {"$ne": {"type": ["boolean", "null"]}}, "required": ["$ne"], "type": "object"}, {"additionalProperties": false, "properties": {"$in": {"default": [], "items": {"type": ["boolean", "null"]}, "minItems": 0, "type": "array", "uniqueItems": true}}, "required": ["$in"], "type": "object"}]}, "created_at": {"anyOf": [{"additionalProperties": false, "properties": {"$gt": {"format": "date-time", "type": "string"}}, "required": ["$gt"], "type": "object"}, {"additionalProperties": false, "properties": {"$gte": {"format": "date-time", "type": "string"}}, "required": ["$gte"], "type": "object"}, {"format": "date-time", "type": "string"}, {"additionalProperties": false, "properties": {"$ne": {"format": "date-time", "type": "string"}}, "required": ["$ne"], "type": "object"}, {"additionalProperties": false, "properties": {"$lt": {"format": "date-time", "type": "string"}}, "required": ["$lt"], "type": "object"}, {"additionalProperties": false, "properties": {"$lte": {"format": "date-time", "type": "string"}}, "required": ["$lte"], "type": "object"}, {"additionalProperties": false, "properties": {"$between": {"default": [], "items": {"format": "date-time", "type": "string"}, "maxItems": 2, "minItems": 2, "type": "array"}}, "required": ["$between"], "type": "object"}, {"additionalProperties": false, "properties": {"$eq": {"format": "date-time", "type": "string"}}, "required": ["$eq"], "type": "object"}]}, "error_msg": {"anyOf": [{"additionalProperties": false, "properties": {"$startswith": {"minLength": 1, "type": "string"}}, "required": ["$startswith"], "type": "object"}, {"maxLength": 255, "type": ["string", "null"]}, {"additionalProperties": false, "properties": {"$contains": {"minLength": 1, "type": "string"}}, "required": ["$contains"], "type": "object"}, {"additionalProperties": false, "properties": {"$ne": {"maxLength": 255, "type": ["string", "null"]}}, "required": ["$ne"], "type": "object"}, {"additionalProperties": false, "properties": {"$iendswith": {"minLength": 1, "type": "string"}}, "required": ["$iendswith"], "type": "object"}, {"additionalProperties": false, "properties": {"$icontains": {"minLength": 1, "type": "string"}}, "required": ["$icontains"], "type": "object"}, {"additionalProperties": false, "properties": {"$endswith": {"minLength": 1, "type": "string"}}, "required": ["$endswith"], "type": "object"}, {"additionalProperties": false, "properties": {"$istartswith": {"minLength": 1, "type": "string"}}, "required": ["$istartswith"], "type": "object"}, {"additionalProperties": false, "properties": {"$in": {"default": [], "items": {"maxLength": 255, "type": ["string", "null"]}, "minItems": 0, "type": "array", "uniqueItems": true}}, "required": ["$in"], "type": "object"}, {"additionalProperties": false, "properties": {"$eq": {"maxLength": 255, "type": ["string", "null"]}}, "required": ["$eq"], "type": "object"}]}, "job": {"anyOf": [{"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/jobs\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}, {"additionalProperties": false, "properties": {"$eq": {"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/jobs\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}}, "required": ["$eq"], "type": "object"}, {"additionalProperties": false, "properties": {"$ne": {"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/jobs\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}}, "required": ["$ne"], "type": "object"}, {"additionalProperties": false, "properties": {"$in": {"default": [], "items": {"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/jobs\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}, "minItems": 0, "type": "array", "uniqueItems": true}}, "required": ["$in"], "type": "object"}]}, "sample": {"anyOf": [{"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/samples\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}, {"additionalProperties": false, "properties": {"$eq": {"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/samples\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}}, "required": ["$eq"], "type": "object"}, {"additionalProperties": false, "properties": {"$ne": {"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/samples\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}}, "required": ["$ne"], "type": "object"}, {"additionalProperties": false, "properties": {"$in": {"default": [], "items": {"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/samples\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}, "minItems": 0, "type": "array", "uniqueItems": true}}, "required": ["$in"], "type": "object"}]}, "success": {"anyOf": [{"type": ["boolean", "null"]}, {"additionalProperties": false, "properties": {"$eq": {"type": ["boolean", "null"]}}, "required": ["$eq"], "type": "object"}, {"additionalProperties": false, "properties": {"$ne": {"type": ["boolean", "null"]}}, "required": ["$ne"], "type": "object"}, {"additionalProperties": false, "properties": {"$in": {"default": [], "items": {"type": ["boolean", "null"]}, "minItems": 0, "type": "array", "uniqueItems": true}}, "required": ["$in"], "type": "object"}]}}, "type": "object"}}, "type": "object"}, "targetSchema": {"items": {"$ref": "#"}, "type": "array"}}, {"href": "/api/v1/controls/public", "method": "GET", "rel": "instances_public", "schema": {"additionalProperties": true, "properties": {"page": {"default": 1, "minimum": 1, "type": "integer"}, "per_page": {"default": 20, "maximum": 1000, "minimum": 1, "type": "integer"}, "sort": {"additionalProperties": false, "properties": {"$uri": {"description": "Sort by $uri in descending order if 'true', ascending order if 'false'.", "type": "boolean"}, "complete": {"description": "Sort by complete in descending order if 'true', ascending order if 'false'.", "type": "boolean"}, "created_at": {"description": "Sort by created_at in descending order if 'true', ascending order if 'false'.", "type": "boolean"}, "error_msg": {"description": "Sort by error_msg in descending order if 'true', ascending order if 'false'.", "type": "boolean"}, "job": {"description": "Sort by job in descending order if 'true', ascending order if 'false'.", "type": "boolean"}, "sample": {"description": "Sort by sample in descending order if 'true', ascending order if 'false'.", "type": "boolean"}, "success": {"description": "Sort by success in descending order if 'true', ascending order if 'false'.", "type": "boolean"}}, "type": "object"}, "where": {"additionalProperties": false, "properties": {"$uri": {"anyOf": [{"pattern": "^\\/api\\/v1\\/controls\\/[^/]+$", "type": "string"}, {"additionalProperties": false, "properties": {"$eq": {"pattern": "^\\/api\\/v1\\/controls\\/[^/]+$", "type": "string"}}, "required": ["$eq"], "type": "object"}, {"additionalProperties": false, "properties": {"$ne": {"pattern": "^\\/api\\/v1\\/controls\\/[^/]+$", "type": "string"}}, "required": ["$ne"], "type": "object"}, {"additionalProperties": false, "properties": {"$in": {"default": [], "items": {"pattern": "^\\/api\\/v1\\/controls\\/[^/]+$", "type": "string"}, "minItems": 0, "type": "array", "uniqueItems": true}}, "required": ["$in"], "type": "object"}]}, "complete": {"anyOf": [{"type": ["boolean", "null"]}, {"additionalProperties": false, "properties": {"$eq": {"type": ["boolean", "null"]}}, "required": ["$eq"], "type": "object"}, {"additionalProperties": false, "properties": {"$ne": {"type": ["boolean", "null"]}}, "required": ["$ne"], "type": "object"}, {"additionalProperties": false, "properties": {"$in": {"default": [], "items": {"type": ["boolean", "null"]}, "minItems": 0, "type": "array", "uniqueItems": true}}, "required": ["$in"], "type": "object"}]}, "created_at": {"anyOf": [{"additionalProperties": false, "properties": {"$gt": {"format": "date-time", "type": "string"}}, "required": ["$gt"], "type": "object"}, {"additionalProperties": false, "properties": {"$gte": {"format": "date-time", "type": "string"}}, "required": ["$gte"], "type": "object"}, {"format": "date-time", "type": "string"}, {"additionalProperties": false, "properties": {"$ne": {"format": "date-time", "type": "string"}}, "required": ["$ne"], "type": "object"}, {"additionalProperties": false, "properties": {"$lt": {"format": "date-time", "type": "string"}}, "required": ["$lt"], "type": "object"}, {"additionalProperties": false, "properties": {"$lte": {"format": "date-time", "type": "string"}}, "required": ["$lte"], "type": "object"}, {"additionalProperties": false, "properties": {"$between": {"default": [], "items": {"format": "date-time", "type": "string"}, "maxItems": 2, "minItems": 2, "type": "array"}}, "required": ["$between"], "type": "object"}, {"additionalProperties": false, "properties": {"$eq": {"format": "date-time", "type": "string"}}, "required": ["$eq"], "type": "object"}]}, "error_msg": {"anyOf": [{"additionalProperties": false, "properties": {"$startswith": {"minLength": 1, "type": "string"}}, "required": ["$startswith"], "type": "object"}, {"maxLength": 255, "type": ["string", "null"]}, {"additionalProperties": false, "properties": {"$contains": {"minLength": 1, "type": "string"}}, "required": ["$contains"], "type": "object"}, {"additionalProperties": false, "properties": {"$ne": {"maxLength": 255, "type": ["string", "null"]}}, "required": ["$ne"], "type": "object"}, {"additionalProperties": false, "properties": {"$iendswith": {"minLength": 1, "type": "string"}}, "required": ["$iendswith"], "type": "object"}, {"additionalProperties": false, "properties": {"$icontains": {"minLength": 1, "type": "string"}}, "required": ["$icontains"], "type": "object"}, {"additionalProperties": false, "properties": {"$endswith": {"minLength": 1, "type": "string"}}, "required": ["$endswith"], "type": "object"}, {"additionalProperties": false, "properties": {"$istartswith": {"minLength": 1, "type": "string"}}, "required": ["$istartswith"], "type": "object"}, {"additionalProperties": false, "properties": {"$in": {"default": [], "items": {"maxLength": 255, "type": ["string", "null"]}, "minItems": 0, "type": "array", "uniqueItems": true}}, "required": ["$in"], "type": "object"}, {"additionalProperties": false, "properties": {"$eq": {"maxLength": 255, "type": ["string", "null"]}}, "required": ["$eq"], "type": "object"}]}, "job": {"anyOf": [{"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/jobs\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}, {"additionalProperties": false, "properties": {"$eq": {"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/jobs\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}}, "required": ["$eq"], "type": "object"}, {"additionalProperties": false, "properties": {"$ne": {"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/jobs\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}}, "required": ["$ne"], "type": "object"}, {"additionalProperties": false, "properties": {"$in": {"default": [], "items": {"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/jobs\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}, "minItems": 0, "type": "array", "uniqueItems": true}}, "required": ["$in"], "type": "object"}]}, "sample": {"anyOf": [{"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/samples\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}, {"additionalProperties": false, "properties": {"$eq": {"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/samples\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}}, "required": ["$eq"], "type": "object"}, {"additionalProperties": false, "properties": {"$ne": {"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/samples\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}}, "required": ["$ne"], "type": "object"}, {"additionalProperties": false, "properties": {"$in": {"default": [], "items": {"anyOf": [{"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/samples\\/[^/]+$", "type": "string"}}, "type": "object"}, {"maxLength": 16, "type": ["string", "null"]}]}, "minItems": 0, "type": "array", "uniqueItems": true}}, "required": ["$in"], "type": "object"}]}, "success": {"anyOf": [{"type": ["boolean", "null"]}, {"additionalProperties": false, "properties": {"$eq": {"type": ["boolean", "null"]}}, "required": ["$eq"], "type": "object"}, {"additionalProperties": false, "properties": {"$ne": {"type": ["boolean", "null"]}}, "required": ["$ne"], "type": "object"}, {"additionalProperties": false, "properties": {"$in": {"default": [], "items": {"type": ["boolean", "null"]}, "minItems": 0, "type": "array", "uniqueItems": true}}, "required": ["$in"], "type": "object"}]}}, "type": "object"}}, "type": "object"}, "targetSchema": {"items": {"$ref": "#"}, "type": "array"}}, {"href": "/api/v1/controls/{id}/results", "method": "GET", "rel": "results", "targetSchema": {"properties": {"analysis_type": {"type": "string"}, "control_job": {"type": "string"}, "false_positive_orgs": {"type": ["null", "string", "number", "boolean", "object", "array"]}, "filename": {"type": "string"}, "metrics": {"type": ["null", "string", "number", "boolean", "object", "array"]}, "product_code": {"type": "string"}, "true_positive_orgs": {"type": ["null", "string", "number", "boolean", "object", "array"]}}, "type": "object"}}, {"href": "/api/v1/controls/{id}", "method": "GET", "rel": "self", "targetSchema": {"$ref": "#"}}], "properties": {"$uri": {"pattern": "^\\/api\\/v1\\/controls\\/[^/]+$", "readOnly": true, "type": "string"}, "complete": {"type": ["boolean", "null"]}, "created_at": {"format": "date-time", "readOnly": true, "type": "string"}, "error_msg": {"maxLength": 255, "type": ["string", "null"]}, "job": {"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/jobs\\/[^/]+$", "type": "string"}}, "type": "object"}, "sample": {"additionalProperties": false, "properties": {"$ref": {"pattern": "^\\/api\\/v1\\/samples\\/[^/]+$", "type": "string"}}, "type": "object"}, "success": {"type": ["boolean", "null"]}}, "type": "object"}